<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>bonding · Xtals.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/flux.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">Xtals.jl</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Xtals</a></li><li><a class="tocitem" href="../matter/">matter</a></li><li><a class="tocitem" href="../box/">boxes</a></li><li><a class="tocitem" href="../crystal/">crystals</a></li><li><a class="tocitem" href="../distance/">computing distances</a></li><li class="is-active"><a class="tocitem" href>bonding</a><ul class="internal"><li><a class="tocitem" href="#Bonding-Rules"><span>Bonding Rules</span></a></li><li><a class="tocitem" href="#Adding-Bonds-to-Crystals"><span>Adding Bonds to Crystals</span></a></li><li><a class="tocitem" href="#Bonds-from-Input-File"><span>Bonds from Input File</span></a></li><li><a class="tocitem" href="#Detailed-Docs"><span>Detailed Docs</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>bonding</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>bonding</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/SimonEnsemble/Xtals.jl/blob/master/docs/src/bonds.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Chemical-Bonding"><a class="docs-heading-anchor" href="#Chemical-Bonding">Chemical Bonding</a><a id="Chemical-Bonding-1"></a><a class="docs-heading-anchor-permalink" href="#Chemical-Bonding" title="Permalink"></a></h1><p>Chemical bonding interactions are represented in the <code>bonds</code> attribute of a <code>Crystal</code> as a <a href="https://github.com/JuliaGraphs/MetaGraphs.jl">graph</a> where the nodes of the graph correspond to the crystal&#39;s <code>atoms</code>.</p><h2 id="Bonding-Rules"><a class="docs-heading-anchor" href="#Bonding-Rules">Bonding Rules</a><a id="Bonding-Rules-1"></a><a class="docs-heading-anchor-permalink" href="#Bonding-Rules" title="Permalink"></a></h2><p><code>Xtals</code> uses a global array of <a href="#Xtals.BondingRule"><code>BondingRule</code></a> structs for deciding if two atoms are an appropriate distance to be chemically bonded.  The default rules are based on the Cordero covalent radii.  Each <a href="#Xtals.BondingRule"><code>BondingRule</code></a> is composed of two chemical species symbols and two floating point values, the minimum and maximum distances for inferring a bond between the indicated species.</p><pre><code class="language-julia">BondingRule(:C, :C, 1.02, 1.77)</code></pre><p>The global bonding rules are available via <a href="#Xtals.get_bonding_rules"><code>get_bonding_rules</code></a> and may be appended with <a href="#Xtals.add_bonding_rules"><code>add_bonding_rules</code></a>, overwritten with <a href="#Xtals.set_bonding_rules"><code>set_bonding_rules</code></a>, or written to/read from disk with <a href="#Xtals.write_bonding_rules"><code>write_bonding_rules</code></a> and <a href="#Xtals.read_bonding_rules"><code>read_bonding_rules</code></a>.</p><h2 id="Adding-Bonds-to-Crystals"><a class="docs-heading-anchor" href="#Adding-Bonds-to-Crystals">Adding Bonds to Crystals</a><a id="Adding-Bonds-to-Crystals-1"></a><a class="docs-heading-anchor-permalink" href="#Adding-Bonds-to-Crystals" title="Permalink"></a></h2><p>By default, bonding information is not added to a <code>Crystal</code>.  Use <a href="#Xtals.infer_bonds!"><code>infer_bonds!</code></a> or <a href="@ref"><code>infer_geometry_based_bonds</code></a> to automatically infer plausible bonds using the global bonding rules, or another specified set of rules.  <a href="#Xtals.remove_bonds!"><code>remove_bonds!</code></a> clears the bonding information from a <code>Crystal</code>.</p><p>Bonds may also be inferred at the time of loading crystal data, using the <code>infer_bonds</code> keyword argument.  See <a href="../crystal/#Xtals.Crystal"><code>Crystal</code></a> for more details.</p><h2 id="Bonds-from-Input-File"><a class="docs-heading-anchor" href="#Bonds-from-Input-File">Bonds from Input File</a><a id="Bonds-from-Input-File-1"></a><a class="docs-heading-anchor-permalink" href="#Bonds-from-Input-File" title="Permalink"></a></h2><p>Some chemical information formats, like <code>.cif</code> and <code>.mol</code>, can store not only the cartesian coordinates of atoms, but also the graph of bonds between atoms in molecules and crystals.  The <code>read_bonds_from_file</code> keyword argument for <a href="../crystal/#Xtals.Crystal"><code>Crystal</code></a> enables loading these bonds when reading the data.  <a href="#Xtals.read_mol"><code>read_mol</code></a> also returns bond information.</p><h2 id="Detailed-Docs"><a class="docs-heading-anchor" href="#Detailed-Docs">Detailed Docs</a><a id="Detailed-Docs-1"></a><a class="docs-heading-anchor-permalink" href="#Detailed-Docs" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="Xtals.BondingRule" href="#Xtals.BondingRule"><code>Xtals.BondingRule</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">bonding_rule = BondingRule(:Ca, :O, 0.4, 2.0)
bonding_rules = [BondingRule(:H, :*, 0.4, 1.2),
                 BondingRule(:*, :*, 0.4, 1.9)]</code></pre><p>A rule for determining if two atoms within a crystal are bonded.</p><p><strong>Attributes</strong></p><ul><li><code>species_i::Symbol</code>: One of the atoms types for this bond rule</li><li><code>species_j::Symbol</code>: The other atom type for this bond rule</li><li><code>min_dist</code>: The minimum distance between the atoms for bonding to occur</li><li><code>max_dist</code>: The maximum distance between the atoms for bonding to occur</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonEnsemble/Xtals.jl/blob/b7820f01ccf900ef440d5e6ae38d1779f0b093af/src/bonds.jl#L1-L13">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Xtals.bondingrules" href="#Xtals.bondingrules"><code>Xtals.bondingrules</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">bond_rules = bondingrules()
bond_rules = bondingrules(covalent_radii=get_covalent_radii(), σ=3., min_tol=0.25)</code></pre><p>Returns a set of bonding rules based on the given Cordero parameters and tolerances.</p><p><strong>Arguments</strong></p><ul><li><code>covalent_radii::Union{Dict{Symbol, Dict{Symbol, Float64}}, Nothing}</code>: Covalent radii and estimated uncertainty. See <a href="#Xtals.get_covalent_radii"><code>get_covalent_radii()</code></a></li><li><code>σ::Float</code>: Number of Cordero estimated standard deviations to use for tolerance on covalent radii.</li><li><code>min_tol::Float</code>: Minimum tolerance for covalent radii.</li></ul><p><strong>Returns</strong></p><ul><li><code>bondingrules::Array{BondingRule, 1}</code>: The default bonding rules: <code>[BondingRule(:*, :*, 0.4, 1.2), BondingRule(:*, :*, 0.4, 1.9)]</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonEnsemble/Xtals.jl/blob/b7820f01ccf900ef440d5e6ae38d1779f0b093af/src/bonds.jl#L32-L46">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Xtals.get_covalent_radii" href="#Xtals.get_covalent_radii"><code>Xtals.get_covalent_radii</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">covalent_radii = get_covalent_radii()</code></pre><p>Create a dictionary with the Cordero covalent radius and estimated standard deviation for each element, using the data in <code>PATH_TO_DATA/cordero.csv</code></p><pre><code class="language-none">covalent_radii = get_covalent_radii()</code></pre><p>Create a dictionary with the Cordero covalent radius and estimated standard deviation for each element specified in <code>PATH_TO_DATA/my_params.csv</code></p><p><strong>Returns</strong></p><ul><li><code>covalent_radii::Dict{Symbol, Dict{Symbol, Float64}}</code>: A dictionary with elements as keys and dictionaries of respective cordero covalent radii and e.s.d.s as the values.</li></ul><p><strong>Example</strong></p><pre><code class="language-julia">covalent_radii = get_covalent_radii()
covalent_radii[:N][:radius_Å] # 0.71
covalent_radii[:N][:esd_Å] # 0.01</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonEnsemble/Xtals.jl/blob/b7820f01ccf900ef440d5e6ae38d1779f0b093af/src/cordero.jl#L1-L19">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Xtals.get_bonding_rules" href="#Xtals.get_bonding_rules"><code>Xtals.get_bonding_rules</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">get_bonding_rules()</code></pre><p>Returns the current global bonding rule set.  Each <a href="#Xtals.BondingRule"><code>BondingRule</code></a> specifies the distance interval over which a specific pair of atomic species are to be considered chemically bonded. The default set of bonding rules is built via <a href="#Xtals.bondingrules"><code>bondingrules</code></a> using the default parameters at package initialization.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonEnsemble/Xtals.jl/blob/b7820f01ccf900ef440d5e6ae38d1779f0b093af/src/bonds.jl#L73-L77">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Xtals.set_bonding_rules" href="#Xtals.set_bonding_rules"><code>Xtals.set_bonding_rules</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">set_bonding_rules(bonding_rules)</code></pre><p>Sets the global bonding rules, overriding the current global rule set.</p><p><strong>Arguments</strong></p><ul><li><code>bonding_rules::Array{BondingRule}</code> : the new global bonding rule set</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonEnsemble/Xtals.jl/blob/b7820f01ccf900ef440d5e6ae38d1779f0b093af/src/bonds.jl#L83-L88">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Xtals.add_bonding_rules" href="#Xtals.add_bonding_rules"><code>Xtals.add_bonding_rules</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">add_bonding_rules(bonding_rules)</code></pre><p>Adds <code>bonding_rules</code> to the beginning of the global bonding rules list</p><p><strong>Arguments</strong></p><ul><li><code>bonding_rules::Array{BondingRule}</code> : the array of bonding rules to add</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonEnsemble/Xtals.jl/blob/b7820f01ccf900ef440d5e6ae38d1779f0b093af/src/bonds.jl#L129-L134">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Xtals.read_bonding_rules" href="#Xtals.read_bonding_rules"><code>Xtals.read_bonding_rules</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">read_bonding_rules(&quot;file.csv&quot;)</code></pre><p>Reads a CSV file of bonding rules and returns a BondingRule array.</p><p><strong>Arguments</strong></p><ul><li><code>filename::String</code> : name of file in data directory containing bonding rules</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonEnsemble/Xtals.jl/blob/b7820f01ccf900ef440d5e6ae38d1779f0b093af/src/bonds.jl#L112-L117">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Xtals.write_bonding_rules" href="#Xtals.write_bonding_rules"><code>Xtals.write_bonding_rules</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">write_bonding_rules(&quot;file.csv&quot;)</code></pre><p>Writes bonding rules to a CSV file that can be loaded with <a href="#Xtals.read_bonding_rules"><code>read_bonding_rules</code></a></p><p><strong>Arguments</strong></p><ul><li><code>filename::String</code> : The name of the output file</li><li><code>bonding_rules::Array{BondingRule}</code> : (Optional) The rules to write to file. If not specified, the global rules are written.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonEnsemble/Xtals.jl/blob/b7820f01ccf900ef440d5e6ae38d1779f0b093af/src/bonds.jl#L94-L100">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Xtals.infer_bonds!" href="#Xtals.infer_bonds!"><code>Xtals.infer_bonds!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">infer_bonds!(crystal, include_bonds_across_periodic_boundaries, bonding_rules=nothing)</code></pre><p>Populate the bonds in the crystal object based on the bonding rules. If a pair doesn&#39;t have a suitable rule then they will not be considered bonded.</p><p><code>:*</code> is considered a wildcard and can be substituted for any species. It is a good idea to include a bonding rule between two <code>:*</code> to allow any atoms to bond as long as they are close enough.</p><p>The bonding rules are hierarchical, i.e. the first bonding rule takes precedence over the latter ones.</p><p><strong>Arguments</strong></p><ul><li><code>crystal::Crystal</code>: The crystal that bonds will be added to</li><li><code>include_bonds_across_periodic_boundaries::Bool</code>: Whether to check across the periodic boundary when calculating bonds</li><li><code>bonding_rules::Union{Array{BondingRule, 1}, Nothing}=nothing</code>: The array of bonding rules that will be used to fill the bonding information. They are applied in the order that they appear. if <code>nothing</code>, default bonding rules will be applied; see <a href="#Xtals.get_bonding_rules"><code>get_bonding_rules</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonEnsemble/Xtals.jl/blob/b7820f01ccf900ef440d5e6ae38d1779f0b093af/src/bonds.jl#L230-L246">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Xtals.remove_bonds!" href="#Xtals.remove_bonds!"><code>Xtals.remove_bonds!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">remove_bonds!(crystal)</code></pre><p>Remove all bonds from a crystal structure, <code>crystal::Crystal</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonEnsemble/Xtals.jl/blob/b7820f01ccf900ef440d5e6ae38d1779f0b093af/src/bonds.jl#L217-L221">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Xtals.infer_geometry_based_bonds!" href="#Xtals.infer_geometry_based_bonds!"><code>Xtals.infer_geometry_based_bonds!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">infer_geometry_based_bonds!(crystal, include_bonds_across_periodic_boundaries::Bool)</code></pre><p>Infers bonds by first finding which atoms share a Voronoi face, and then bond the atoms if the distance  between them is less than the sum of the covalent radius of the two atoms (plus a tolerance).</p><p><strong>Arguments</strong></p><ul><li><code>crystal::Crystal</code>: The crystal structure</li><li><code>include_bonds_across_periodic_boundaries::Bool</code>: Whether to check across the periodic boundaries</li><li><code>r::Float</code>: voronoi radius, Å</li><li><code>σ::Float</code>: number of estimated standard deviations to use for covalent radius tolerance</li><li><code>min_tol::Float</code>: minimum tolerance for calculated bond distances, Å</li><li><code>covalent_radii::Dict{Symbol, Dict{Symbol, Float64}}</code>: See <a href="@ref"><code>covalent_radii</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonEnsemble/Xtals.jl/blob/b7820f01ccf900ef440d5e6ae38d1779f0b093af/src/bonds.jl#L387-L400">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Xtals.write_bond_information" href="#Xtals.write_bond_information"><code>Xtals.write_bond_information</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">write_bond_information(crystal, filename)
write_bond_information(crystal, center_at_origin=false)
write_bond_information(xtal, filename, :cross_boundary =&gt; p -&gt; p, &quot;bonds.vtk&quot;) # cross boundary bonds only
write_bond_information(xtal, filename, :distance =&gt; d -&gt; d &lt; 1.0, &quot;bonds.vtk&quot;) # distance less than 1.0</code></pre><p>Writes the bond information from a crystal to the selected filename.</p><p><strong>Arguments</strong></p><ul><li><code>crystal::Crystal</code>: The crystal to have its bonds written to a vtk file</li><li><code>filename::String</code>: The filename the bond information will be saved to. If left out, will default to crystal name.</li><li><code>center_at_origin::Bool</code>: center the coordinates at the origin of the crystal</li><li><code>bond_filter::Pair{Symbol, Function}</code>: a key-value pair of an edge attribute and a predicate function. Bonds with attributes that cause the predicate to return false are excluded from writing.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonEnsemble/Xtals.jl/blob/b7820f01ccf900ef440d5e6ae38d1779f0b093af/src/bonds.jl#L455-L468">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Xtals.read_mol" href="#Xtals.read_mol"><code>Xtals.read_mol</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">atoms, bonds = read_mol(&quot;molecule.mol&quot;)</code></pre><p>read a <code>.mol</code> file, which contains info about both atoms and bonds. see <a href="https://chem.libretexts.org/Courses/University_of_Arkansas_Little_Rock/ChemInformatics_(2017)%3A_Chem_4399%2F%2F5399/2.2%3A_Chemical_Representations_on_Computer%3A_Part_II/2.2.2%3A_Anatomy_of_a_MOL_file">here</a> for the anatomy of a <code>.mol</code> file.</p><p><strong>Arguments</strong></p><ul><li><code>filename::AbstractString</code>: the path to and filename of the .mol file (must pass extension)</li></ul><p><strong>Returns</strong></p><ul><li><code>atoms::Atoms{Cart}</code>: the set of atoms read from the <code>.mol</code> file.</li><li><code>bonds::MetaGraph</code>: the bonding graph of the atoms read from the <code>.mol</code> file.</li><li><code>bond_types::Array{Int, 1}</code>: the array of bond types.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonEnsemble/Xtals.jl/blob/b7820f01ccf900ef440d5e6ae38d1779f0b093af/src/misc.jl#L65-L78">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../distance/">« computing distances</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Wednesday 3 March 2021 22:56">Wednesday 3 March 2021</span>. Using Julia version 1.5.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
